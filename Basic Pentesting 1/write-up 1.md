|---|---|
|:---|:----|
| Category: |	Small boot2root VM |
|Platform: |	Vulnhub |
|Vulnerability: | Fpt |
|End Goal: |	Get root |
|Tool: |	Wpscan, nikto, msfconsole |
|Tag:	| |

## Pennetration Methodologie
- Scan the target
  - Find target's IP
  - Nmap scan
- Enumeration
  - FTP vuln scan
- Exploit
## Walkthrough
### Scanning
- Firstly I find the target’s IP by using **netdiscover** tool, we can easily find ip of the victim machine
```
┌──(root㉿kali)-[/home/kali]
└─# netdiscover -i eth0 -r 192.168.44.0/24

Currently scanning: Finished!   |   Screen View: Unique Hosts                                                               17 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 1020                                                           
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
 -----------------------------------------------------------------------------
 192.168.44.2    00:50:56:f2:22:8b      6     360  VMware, Inc.                                                                    
 192.168.44.1    00:50:56:c0:00:08      1      60  VMware, Inc.                                                                    
 192.168.44.130  00:0c:29:0e:97:6e      8     480  VMware, Inc.                                                                    
 192.168.44.254  00:50:56:e3:25:b0      2     120  VMware, Inc.
```
Target: **192.168.44.130** 
- Let's continue with **Nmap** scan.
```
┌──(root㉿kali)-[/home/kali]
└─# nmap -sV -sC -Pn -T4  192.168.44.130
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-15 17:24 EDT
Nmap scan report for 192.168.44.130
Host is up (0.00088s latency).
Not shown: 997 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
21/tcp open  ftp     ProFTPD 1.3.3c
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 d6:01:90:39:2d:8f:46:fb:03:86:73:b3:3c:54:7e:54 (RSA)
|   256 f1:f3:c0:dd:ba:a4:85:f7:13:9a:da:3a:bb:4d:93:04 (ECDSA)
|_  256 12:e2:98:d2:a3:e7:36:4f:be:6b:ce:36:6b:7e:0d:9e (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache/2.4.18 (Ubuntu)
MAC Address: 00:0C:29:0E:97:6E (VMware)
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.12 seconds
```
From this we can see the following ports and services:
- 21/tcp open  ftp     ProFTPD 1.3.3c
- 22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8
- 80/tcp open  http    Apache httpd 2.4.18
Check http servive
![image](https://github.com/CowStupid/Vulnhub-seri/assets/169901923/26e3bb4b-1690-4ca9-8e12-d8085bc0bbea)
Nothing here. Scan Web with nikto
### Enumeration
#### FTP vuln scan
Use Nmap vuln scan to find scan ftp service 
```
┌──(root㉿kali)-[/home/kali]
└─# nmap -sV -sC -Pn -T4 --script=vuln -p 21 192.168.44.130
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-15 17:35 EDT
Nmap scan report for 192.168.44.130
Host is up (0.0018s latency).

PORT   STATE SERVICE VERSION
21/tcp open  ftp     ProFTPD 1.3.3c
| ftp-proftpd-backdoor: 
|   This installation has been backdoored.
|   Command: id
|_  Results: uid=0(root) gid=0(root) groups=0(root),65534(nogroup)
```
From the result, there are a FTP vulnerability.
#### Dictionary Emunmeration
Use gobuster to find hidden dicrectory in website
```
┌──(root㉿kali)-[/home/kali]
└─# gobuster dir -u http://192.168.44.130/ -w /usr/share/wordlists/dirb/common.txt 
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.44.130/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirb/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.hta                 (Status: 403) [Size: 279]
/.htpasswd            (Status: 403) [Size: 279]
/.htaccess            (Status: 403) [Size: 279]
/index.html           (Status: 200) [Size: 177]
/secret               (Status: 301) [Size: 317] [--> http://192.168.44.130/secret/]
/server-status        (Status: 403) [Size: 279]
Progress: 4614 / 4615 (99.98%)
===============================================================
Finished
===============================================================
```
Oh, we find a interesting dictionary that is **secret**. Check in URL, I find a wordpress login page.
![image](https://github.com/CowStupid/Vulnhub-seri/assets/169901923/6d6d58bc-0d43-4687-be61-c312f9038e37)
Conclusion: we have two way can be exploited
- ftp-proftpd-backdoor
- wordpress login exploit
## Exploit 
- FPT exploit
The frist I use **searchexploit** to find the way exploit



